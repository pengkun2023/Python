# 列表

## 序列的本质和内存结构

- 序列是Python中最基本的数据结构

- 序列是一种数据存储方式，用来存储一系列的数据。在内存中，序列就是一块用来存放多个值的连续的内存空间

- 在Python3中一切皆对象，但是序列在内存中存储的是对象的地址，而不是对象的值

- 序列中的每个值都有对应的位置值，称之为索引，第一个索引值是0，第二个索引值是1，以此类推。

- Python中有6个序列的内置类型，但最常见的是列表和元组

___

## 列表的简介

1. 列表：用于存储任意数目、任意类型的数据集合

2. 列表是内置可变序列，是包含多个元素的有序连续的内存空间。列表的标准语法格式为：`a = [10, 20, 30, 40]` 其中10，20，30，40这些称为：列表a的**元素**。

3. 列表中的元素可以各不相同，可以是任意类型。比如：`a = [10, 20, 'abc', True]` 

4. Python的列表大小可变，根据需要随时增加或缩小。

列表对象的常用方法汇总如下

| 方法                   | 要点     | 描述                                 |
| -------------------- | ------ | ---------------------------------- |
| list.append(x)       | 增加元素   | 将元素x增加到列表list尾部                    |
| list.extend(aList)   | 增加元素   | 将列表aList所有元素加到列表list尾部             |
| list.insert(index,x) | 增加元素   | 在列表list指定位置index处插入元素x             |
| list.remove(x)       | 删除元素   | 在列表list中删除首次出现的指定元素x               |
| list.pop([index])    | 删除元素   | 删除并返回列表list指定为止index处的元素，默认是最后一个元素 |
| list.clear()         | 删除所有元素 | 删除列表所有元素，并不是删除列表对象                 |
| list.index(x)        | 访问元素   | 返回第一个x的索引位置，若不存在x的元素则抛出异常          |
| list.count(x)        | 计数     | 返回第一个x的索引位                         |
| len(list)            | 列表长度   | 返回列表中包含元素的个数                       |
| list.reverse()       | 翻转列表   | 所有元素原地翻转                           |
| list.sort()          | 排序     | 所有元素原地排序                           |
| list.copy()          | 浅拷贝    | 返回列表对象的浅拷贝                         |

> 字符串和列表都是序列类型，一个字符串是一个字符序列，一个列表是任何元素的序列。

示例:

```python
a = [10, 20, 30, 40]    # 创建一个名为a的列表
b = [100, 200]
print(a[1])     # 切片操作读取下标为1的值
a.append(50)    # 添加50
print(a)
a.extend(b)     # 将列表b中的元素添加到列表a中
print(a)
a.insert(5,60)  # 在列表a下标为5的位置添加60这个数字
print(a)
a.remove(100)    # 删除列表a中一个100
print(a)
a.pop(0)        # 删除列表a中下标为0的元素
print(a)
b.clear()        # 删除列表b中的所有的元素
print(b)

a.reverse()        # 将列表a原地翻转
print(a)
a.sort()        # 将列表a排序
print(a)
a.copy()        # 返回列表a的浅拷贝
print(a)
```

运行结果为：

```
20
[10, 20, 30, 40, 50]
[10, 20, 30, 40, 50, 100, 200]
[10, 20, 30, 40, 50, 60, 100, 200]
[10, 20, 30, 40, 50, 60, 200]
[20, 30, 40, 50, 60, 200]
[]
[200, 60, 50, 40, 30, 20]
[20, 30, 40, 50, 60, 200]
[20, 30, 40, 50, 60, 200]
```

___

## 列表的创建

创建一个列表可以有多种方法：

### 基本语法`[]` 创建

```python
a = [10, 20, 'pengkun', 'sweet']
b = []    # 创建一个空的列表对象
print(a)
```

运行结果:

```
[10, 20, 'pengkun', 'sweet']
```

### list()创建

使用`list()` 可以将任何可迭代的数据转化为列表

```python
a = list()    # 创建一个空的列表对象
b = list(range(10))
c = list("pengkun,sweet")
print(a)
print(b)
print(c)
```

运行结果：

```
[]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
['p', 'e', 'n', 'g', 'k', 'u', 'n', ',', 's', 'w', 'e', 'e', 't']
```

### range()创建整数列表

range()可以帮助我们非常方便的创建整数列表，这在开发中及其有用。

**语法格式为:**

`range([start],[end],[step])`

> start参数：可选，表示起始数字。默认是0
> 
> end参数：必选，表示结尾数字
> 
> step参数：可选，表示步长，默认是1

即：range()中必须输入end参数

> Python3 中range()返回的是一个range对象，而不是列表。我们需要通过list()方法将其转换为列表对象。

示例:

```python
a = list(range(3,15,2))
b = list(range(15,9,-1))
c = list(range(3,-4,-1))
print(a,b,c)
```

运行结果为:

```
[3, 5, 7, 9, 11, 13] [15, 14, 13, 12, 11, 10] [3, 2, 1, 0, -1, -2, -3]
```

### 推导式生成列表

使用列表推导式可以非常方便的创建列表，在开发中经常使用。

简单示例:

```python
# 循环创建多个元素[0, 2, 4, 6, 8]
a = [x*2 for x in range(5)]

# 通过if过滤元素[0, 18, 36, 54, 72, 90, 108, 126, 144, 162, 180, 198]
b = [x*2 for x in range(100) if x%9 == 0]

print(a)
print(b)
```

运行结果:

```
[0, 2, 4, 6, 8]
[0, 18, 36, 54, 72, 90, 108, 126, 144, 162, 180, 198]
```

___

## 添加列表元素

> 当列表添加和删除元素时，列表会自动进行内存管理，大大减少了程序员的负担。但这个特点涉及到列表元素的大量移动，效率极低。
> 
> :exclamation: 除非必要，一般只在列表尾部添加元素或删除元素，这会大大提高列表的操作效率

### append()方法

原地修改列表元素，是真正的列表尾部添加新的元素，**速度最快，推荐使用**

```python
a = [20, 40]
a.append(80)
print(a)
```

运行结果:

```
[20, 40, 80]
```

### `+` 运算符操作

并不是真正的在列表尾部添加元素，而是创建新的列表对象；将原列表的元素和新列表的元素依次复制到新的列表对象中。这样，会涉及大量的复制操作，对于操作大量元素不建议使用该方法！

```python
a = [20, 40]
print(id(a))    # 打印a的地址
a = a + [50]
print(id(a))    # 打印a的地址
```

运行结果:

```
2560023458368
2560026446080
```

根据以上测试，发现变量a的地址发生了变化。也就是创建了新的列表对象

### extend()方法

将目标列表的所有元素添加到本列表的尾部，属于原地操作，不创建新的列表对象

```python
a = [20, 40]
print(id(a))
b = [50, 60]
a.extend(b)    # 原对象修改
print(id(a))
a = a + b    # 产生新的对象
print(id(a))
```

运行结果:

```
2405335298624
2405335298624
2405337827584
```

### insert()插入元素

使用`insert()` 方法可以将指定的元素插入到列表对象的任意指定位置。这样会让插入位置后面所有的元素进行移动，会影响处理速度。涉及大量元素时，尽量避免使用。类似发生这种移动的函数还有:`remove()` 、`pop()` 、`del()`，它们在删除**非尾部元素**时也会发生操作位置后面元素的移动

```python
a = [10, 20, 30]
a.insert(2,100)
print(a)
```

运行结果:

```
[10, 20, 100, 30]
```

### 乘法扩展

使用乘法扩展，生成一个新列表，新列表元素时原列表元素的多次重复。

```python
a = ['sweet', 100]
b = a * 3
print(a)
print(b)
```

运行结果:

```
['sweet', 100]
['sweet', 100, 'sweet', 100, 'sweet', 100]
```

适用于乘法操作的还有：字符串、元组。例如：

```python
c = 'sweet'
d = c * 3
print(d)
```

运行结果为:

```
sweetsweetsweet
```

___

## 列表元素的删除

- 删除元素的本质是：元素的拷贝

### del删除

删除列表指定位置的元素。

```python
a = [100, 200, 888, 300, 400]
del a[2]
print(a)
```

运行结果为:

```
[100, 200, 300, 400]
```

### pop()方法

`pop()` 删除并返回指定位置元素，如果未指定位置则默认操作列表最后一个元素

```python
a = [10, 20, 30, 40, 50]
b1 = a.pop()    # 结果为b1 = 50
print(a,b1)     # 结果为[10, 20, 30, 40] 50
b2 = a.pop(1)
print(a,b2)    # 结果为[10, 20, 40] 20
```

### remove()方法

删除首次出现的指定元素，若不存在该元素抛出异常

```python
a = [10, 20, 30, 40, 50, 20, 30, 20, 30]
a.remove(20)     # [10, 30, 40, 50, 20, 30, 20, 30]
a.remove(100)    # 报错: ValueError:list.remove(x): x not in list
```

___

## 列表元素访问和计数

### 通过索引直接访问元素

我们可以通过索引直接访问元素，索引区间在`[0,列表长度-1]` 这个范围。超过这个范围则会抛出异常。

```python
a = [10, 20, 30, 40, 50, 20, 30, 20, 30]
print(a[2])       # 结果：30
print(a[10])      # 报错: IndexError:list index out of range
```

### index()获得指定元素在列表中首次出现的索引

`index()` 可以获取指定元素首次出现的索引位置。语法为

`index(value,[start,[end]])` 其中`start`和`end` 指定了搜索的范围

```python
a = [10, 20, 30, 40, 50, 20, 30, 20, 30]
print(a.index(20))    # 结果: 1
print(a.index(20,3))   # 结果：5 从索引位置3开始往后搜索的第一个20
print(a.index(30,5,7))  # 结果：6 从索引位置5到7这个区间，第一次出现30元素的位置
```

### count()获得指定元素在列表中出现的次数

`count()` 可以返回指定元素在列表中出现的次数

```python
a = [10, 20, 30, 40, 50, 20, 30, 20, 30]
print(a.count(20))    # 结果为： 3
```

### len()返回列表长度

`len()` 返回列表长度，即列表中包括元素的个数

```python
a = [10, 20, 30, 40]
print(len(a))    # 结果为: 4
```

### 成员资格判断

判断列表中是否存在指定的元素，可以使用`count()`方法，返回0则表示不存在，返回大于0则表示存在，但是，一般我们会使用更加简洁的`in` 关键字来判断，直接返回`True` 或`False`

```python
a = [10, 20, 30, 40, 50, 20, 30, 20, 30]
print(20 in a)    # 结果：True
print(100 in a)    # 结果：False
print(10 not in a) # 结果: False
```

### 切片操作

> 类似于字符串的切片操作，对于列表的切片操作和字符串类似

切片是Python序列及其重要的操作，适用于列表、元组、字符串等等。

切片slice操作可以让我们快速提取子列表或修改。标准格式为:

`[起始偏移量start:终止偏移量end[步长step]]` 

典型操作(三个量为正数的情况)如下:

| 操作和说明                                     | 示例                                       | 结果             |
| ----------------------------------------- | ---------------------------------------- | -------------- |
| `[:]` 提取整个列表                              | `[10, 20, 30]`  `[:]`                    | `[10, 20, 30]` |
| `[start:]`从start索引开始到结尾                   | `[10, 20, 30]` `[1:]`                    | `[20, 30]`     |
| `[:end]`从头开始直到end-1                       | `[10, 20, 30]` `[:2]`                    | `[10, 20]`     |
| `[start:end]`从start到end-1                 | `[10, 20, 30, 40]` `[1:3]`               | `[20, 30]`     |
| `[start:end:step]` 从start提取到end-1，步长为step | `[10, 20, 30, 40, 50, 60, 70]` `[1:6:2]` | `[20, 40, 60]` |

其他操作（三个量为负数）的情况：

| 示例                                       | 说明                 | 结果                             |
| ---------------------------------------- | ------------------ | ------------------------------ |
| `[10, 20, 30, 40, 50, 60, 70]` `[-3:]`   | 倒数三个               | `[50, 60, 70]`                 |
| `[10, 20, 30, 40, 50, 60, 70]` `[-5:-3]` | 倒数第五个到倒数第三个（包头不包尾） | `30, 40`                       |
| `[10, 20, 30, 40, 50, 60, 70]` `[::-1]`  | 步长为负，从右到左反向提取      | `[70, 60, 50, 40, 30, 20, 10]` |

- 切片操作时，起始偏移量和终止偏移量不在`[0, 字符串长度-1]`这个给范围，也不会报错。起始偏移量`小于0` 则会当作`0` ,终止偏移量`大于"长度-1"`会被当成`"长度-1"`。例如：

- ```python
  a = [10, 20, 30, 40]
  b = [1:30]
  
  print(b)
  ```

- 运行结果为：

- ```python
  [20, 30, 40]
  ```

发现正常输出了结果，没有报错！

___

## 列表的遍历

```python
a = [10, 20, 30, 40]
for obj in a:
    print(obj)
```

运行结果为:

```
10
20
30
40
```

___

## 复制列表所有的元素到新列表对象

如下代码实现列表元素的复制了吗？

```python
list1 = [30, 40, 50]
list2 = list1
```

只是将list2指向了列表对象list2，也就是说list2和list1持有的地址值是相同的，列表对象本身的元素并没有复制！

可以通过以下简单方式，实现列表元素内容的复制:

```python
list1 = [30, 40, 50]
list2 = [] + list1    # 生成新的对象
print(list2)
```

运行结果

```
[30, 40, 50]
```

- 注：也可以使用浅复制或深复制实现复制操作！

___

## 列表排序



### 修改原列表，不创建新列表的排序

```python
a = [20, 10, 30, 40]
print(id(a))

a.sort()    # 默认是升序排序
print(a)

a = [10, 20, 30, 40]    # 重新重新定义列表a
a.sort(reverse=True)    # 降序排序
print(a)

import random
random.shuffle(a)    # 使用随机数打乱顺序
print(a)
```

运行结果为：

```
1767426356032
[10, 20, 30, 40]
[40, 30, 20, 10]
[30, 20, 40, 10]
```



### 建新列表的排序

我们也可以通过内置函数`sorted()` 进行排序，这个方法返回新列表，不对原列表做修改

```python
a = [20, 10, 30, 40]
print(id(a))

b = sorted(a)    # 默认升序
print(b)
print(id(b))

c = sorted(a,reverse=True)    # 降序
print(c)
```

运行结果为:

```
2576626611008
[10, 20, 30, 40]
2576626577664
[40, 30, 20, 10]
```

通过上面操作，可以看出来，生成的列表对象b和c都是完全新的列表对象



### reversed()返回迭代器

内置函数reversed()也支持进行逆序排序，与列表对象reverse()方法不同的是，内置函数reversed()不对原列表做任何修改，只是返回一个逆序的迭代器对象

```python
a = [20, 10, 30, 40]
c = reversed(a)
print(c)
print(list(c))
print(list(c))
```

运行结果:

```
<list_reverseiterator object at 0x000001DE7EF7C970>
[40, 30, 20, 10]
[]
```

我们打印输出c发现提示是：list_reverseiterator。也就是一个迭代对象。同时，我们使用list(c)进行输出，发现只能使用一次。第一次输出了元素，第二次为空。那是因为迭代对象在第一次时已经遍历结束了，第二次不能再使用。

___



## 列表相关的其他内置函数汇总

### max和min

用于返回列表的最大值和最小值

```python
a = [29, 19, 39, 1, 3, 5]
b = max(a)
c = min(a)

massage1 = f"最大值是:{b}"
massage2 = f"最小值是:{c}"

print(massage1)
print(massage2)
```

运行结果:

```
最大值是:39
最小值是:1
```

### sum

对数值型列表的所有元素进行求和操作，对非数值型列表运算则会报错。

```python
a = [3, 10, 20, 15, 9]
print(sum(a))    # 运行结果为57
```
